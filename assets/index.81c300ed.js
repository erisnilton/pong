var k=Object.defineProperty;var T=(o,t,e)=>t in o?k(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var n=(o,t,e)=>(T(o,typeof t!="symbol"?t+"":t,e),e);const E=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}};E();class h{constructor(t=0,e=t){this.x=t,this.y=e}set(t,e=t){return this.x=t,this.y=e,this}get magnitude(){return Math.hypot(this.x,this.y)}get int(){return new h(Math.ceil(this.x),Math.ceil(this.y))}copy(){return new h(this.x,this.y)}copyTo(t){return t.set(this.x,this.y),t}copyFrom(t){return this.set(t.x,t.y),this}add(t){return this.x+=t.x,this.y+=t.y,this}scale(t){return this.x*=t.x,this.y*=t.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}div(t){return this.x/=t.x,this.y/=t.y,this}normalize(){return this.div(new h(this.magnitude))}}class l{constructor(){n(this,"game");n(this,"parent");n(this,"pivot",new h(0,0));n(this,"position",new h(0,0));n(this,"angle",0)}setup(){}update(t){}destroy(){}prepareCanvas(t,e){t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.angle),t.translate(this.pivot.x,this.pivot.y),e(),t.restore()}}class v extends l{constructor(){super(...arguments);n(this,"children",[])}add(e){return e.game=this.game,e.parent=this,e.setup(),this.children.push(e),this}remove(e){e.destroy(),delete e.parent,delete e.game;const i=this.children.indexOf(e);return i>=0&&this.children.splice(i,1),this}render(e){return this.prepareCanvas(e,()=>{this.children.forEach(i=>i.render(e))})}update(e){this.children.forEach(i=>i.update(e))}setup(){this.children.forEach(e=>e.setup())}}class L{constructor(){n(this,"nextFrame");n(this,"queue",new Set);n(this,"frameTime",1e3/60);n(this,"lastTime",0)}get fps(){return 1e3*this.frameTime}set fps(t){this.frameTime=1e3/t}add(t){return this.queue.add(t),this}remove(t){return this.queue.delete(t),this}update(t=performance.now()){if(this.lastTime!=0){const e=t-this.lastTime,i=this.frameTime/e;this.queue.forEach(s=>s(i))}this.lastTime=t}start(){this.stop();const t=e=>{this.update(e),this.nextFrame=requestAnimationFrame(t)};this.nextFrame=requestAnimationFrame(t)}stop(){cancelAnimationFrame(this.nextFrame)}}class M{constructor(t){n(this,"context");n(this,"stage",new v);n(this,"ticker",new L);this.view=t,this.context=t.getContext("2d"),this.ticker.add(e=>this.update(e)),this.stage.game=this,this.stage.setup(),this.ticker.start()}render(){return this.context.resetTransform(),this.context.clearRect(0,0,this.view.width,this.view.height),this.stage.render(this.context)}update(t){this.stage.update(t),this.render()}}class y extends v{constructor(t){super(),this.options=t}render(t){const{width:e,height:i}=this.options;return this.prepareCanvas(t,()=>{t.beginPath(),t.rect(0,0,e,i),t.stroke()}),super.render(t)}}class P extends l{constructor(e){super();n(this,"radius",8);n(this,"velocity",new h(3));n(this,"onKeydown",e=>{e.key===" "&&this.start()});this.options=e}collidesPoint(e){const i=this.position.x-e.x,s=this.position.y-e.y;return i**2+s**2<this.radius**2}collidesPlayer(e){const i=Math.max(e.position.x,Math.min(this.position.x,e.position.x+e.width)),s=Math.max(e.position.y,Math.min(this.position.y,e.position.y+e.height));return this.collidesPoint(new h(i,s))}render(e){this.prepareCanvas(e,()=>{e.beginPath(),e.arc(0,0,this.radius,0,Math.PI*2),e.closePath(),e.fill()})}update(e){this.position.add(this.velocity.copy().scale(new h(e))),this.position.y-this.radius<0?(this.position.y=this.radius,this.velocity.scale(new h(1,-1))):this.position.y+this.radius>this.parent.options.height&&(this.position.y=this.parent.options.height-this.radius,this.velocity.scale(new h(1,-1)));const i=this.options.players.find(s=>this.collidesPlayer(s));if(this.position.x>=this.parent.options.width)this.options.players[0].score++,this.reset();else if(this.position.x<=0)this.options.players[1].score++,this.reset();else if(i){this.velocity.scale(new h(-1,-1));const s=Math.sign(this.velocity.x);s===1?this.position.x=i.position.x+i.width+this.radius:s===-1&&(this.position.x=i.position.x-this.radius)}}reset(){this.position.set(this.parent.options.width/2,this.parent.options.height/2),this.velocity.set(0,0)}start(){if(this.velocity.magnitude===0){const e=(...i)=>i[Math.floor(Math.random()*i.length)];this.velocity.set(e(-4,4),e(-4,4))}}setup(){if(!(this.parent instanceof y))throw new TypeError("Um jogador deve ser adicionado somente em uma instancia de Table.");this.reset(),window.addEventListener("keydown",this.onKeydown)}destroy(){window.removeEventListener("keydown",this.onKeydown)}}class x extends l{constructor(e){super();n(this,"width",16);n(this,"height",64);n(this,"score",0);n(this,"keys",{up:!1,down:!1});n(this,"onKeyUp",e=>{const i=this.options.keys[e.key];i&&this.keys[i]&&(this.keys[i]=!1)});n(this,"onKeyDown",e=>{const i=this.options.keys[e.key];i&&!this.keys[i]&&(this.keys[i]=!0)});this.options=e}render(e){return this.prepareCanvas(e,()=>{var i;e.fillStyle=(i=this.options.color)!=null?i:"transparent",e.fillRect(0,0,this.width,this.height)})}update(e){const s=this.parent.options.height-this.height;this.keys.up?this.position.y-=e*10:this.keys.down&&(this.position.y+=e*10),this.position.y<0?this.position.y=0:this.position.y>s&&(this.position.y=s)}setup(){if(!(this.parent instanceof y))throw new TypeError("Um jogador deve ser adicionado somente em uma instancia de Table.");window.addEventListener("keyup",this.onKeyUp),window.addEventListener("keydown",this.onKeyDown)}destroy(){window.removeEventListener("keyup",this.onKeyUp),window.removeEventListener("keydown",this.onKeyDown)}}class b extends l{constructor(t){super(),this.options=t}render(t){return this.prepareCanvas(t,()=>{var s,r,d,w,m,g;const{style:e,text:i}=this.options;t.textAlign=(s=e.align)!=null?s:"left",t.textBaseline=(r=e.verticalAlign)!=null?r:"top",t.font=`${(w=(d=e.font)==null?void 0:d.weight)!=null?w:"normal"} ${(m=e.font)==null?void 0:m.size}px ${(g=e.font)==null?void 0:g.family}`,t.fillText(i,0,0)})}}class K extends b{constructor(t){super({style:{fill:"red",align:"center",font:{size:32,family:"Arial",weight:"bolder"}},text:""}),this.players=t}setup(){const{options:{width:t}}=this.parent;this.position.set(t/2,-50)}update(){this.options.text=this.players.map(t=>t.score).join(" | ")}}const f=document.getElementById("app");f.width=document.body.clientWidth;f.height=document.body.clientHeight;const u=new M(f),a=new y({width:800,get height(){return this.width/2}});u.stage.add(a);a.pivot.set(a.options.width/-2,a.options.height/-2);a.position.set(u.view.width/2,u.view.height/2);const c=new x({color:"green",keys:{a:"up",d:"down"}}),p=new x({color:"yellow",keys:{ArrowLeft:"up",ArrowRight:"down"}});c.position.set(32,0);p.position.set(a.options.width-p.width-32,0);const A=new K([c,p]),F=new P({players:[c,p]});a.add(c).add(p).add(F).add(A);
